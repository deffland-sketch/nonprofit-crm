{% extends "base.html" %}

{% block title %}Import Donors - Non-Profit CRM{% endblock %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-lg-8">
        <div class="d-flex justify-content-between align-items-center mb-4">
            <div>
                <a href="{{ url_for('import_data') }}" class="text-decoration-none">
                    <i class="bi bi-arrow-left me-1"></i>Back to Import
                </a>
                <h1 class="mt-2 mb-0">Import Donors</h1>
            </div>
        </div>

        <div class="card mb-4">
            <div class="card-header">
                <h5 class="mb-0"><i class="bi bi-upload me-2"></i>Upload Excel File</h5>
            </div>
            <div class="card-body">
                <form method="POST" enctype="multipart/form-data">
                    {{ form.hidden_tag() }}

                    <div class="mb-3">
                        <label class="form-label">Excel File (.xlsx)</label>
                        {{ form.file(class="form-control", accept=".xlsx,.xls") }}
                        {% if form.file.errors %}
                            <div class="text-danger small">{{ form.file.errors[0] }}</div>
                        {% endif %}
                    </div>

                    <div class="d-flex gap-2">
                        <button type="submit" class="btn btn-primary">
                            <i class="bi bi-upload me-1"></i>Import Donors
                        </button>
                        <a href="{{ url_for('import_data') }}" class="btn btn-outline-secondary">Cancel</a>
                    </div>
                </form>
            </div>
        </div>

        <div class="card">
            <div class="card-header">
                <h5 class="mb-0"><i class="bi bi-table me-2"></i>Expected Format</h5>
            </div>
            <div class="card-body">
                <p>Your Excel file should have a header row with the following columns:</p>

                <div class="table-responsive">
                    <table class="table table-sm">
                        <thead>
                            <tr>
                                <th>Column</th>
                                <th>Required</th>
                                <th>Accepted Names</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>First Name</td>
                                <td><span class="badge bg-danger">Required</span></td>
                                <td>First Name, First, FirstName</td>
                            </tr>
                            <tr>
                                <td>Last Name</td>
                                <td><span class="badge bg-danger">Required</span></td>
                                <td>Last Name, Last, LastName, Surname</td>
                            </tr>
                            <tr>
                                <td>Email</td>
                                <td><span class="badge bg-secondary">Optional</span></td>
                                <td>Email, E-mail, Email Address</td>
                            </tr>
                            <tr>
                                <td>Phone</td>
                                <td><span class="badge bg-secondary">Optional</span></td>
                                <td>Phone, Telephone, Phone Number</td>
                            </tr>
                            <tr>
                                <td>Address</td>
                                <td><span class="badge bg-secondary">Optional</span></td>
                                <td>Address, Street, Street Address</td>
                            </tr>
                            <tr>
                                <td>City</td>
                                <td><span class="badge bg-secondary">Optional</span></td>
                                <td>City, Town</td>
                            </tr>
                            <tr>
                                <td>State</td>
                                <td><span class="badge bg-secondary">Optional</span></td>
                                <td>State, Province, Region</td>
                            </tr>
                            <tr>
                                <td>ZIP Code</td>
                                <td><span class="badge bg-secondary">Optional</span></td>
                                <td>ZIP, Zip Code, Postal, Postal Code</td>
                            </tr>
                            <tr>
                                <td>Interests</td>
                                <td><span class="badge bg-secondary">Optional</span></td>
                                <td>Interests, Interest, Areas of Interest</td>
                            </tr>
                            <tr>
                                <td>Notes</td>
                                <td><span class="badge bg-secondary">Optional</span></td>
                                <td>Notes, Note, Comments</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="alert alert-info mb-0">
                    <i class="bi bi-info-circle me-2"></i>
                    Donors with matching names or email addresses will be skipped to avoid duplicates.
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
